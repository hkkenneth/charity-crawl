<html>
<head>
<style>
    .slide-tag.nt {
        background-color: green !important;
    }
    .slide-tag.kl {
        background-color: red !important;
    }
    .slide-tag.hk {
        background-color: blue !important;
    }
    .slide-tag.all {
        background-color: orange !important;
    }
</style>
</head>
<body>
<div id="timeline-embed"></div>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">
         var timeline_config = {
             width:              '100%',
             height:             '600',
             source:             'https://docs.google.com/spreadsheet/pub?key=0AoAq5d8Y6oJQdDBKTkZJUjZkTHgwT09ub1c3N3EyMWc&single=true&gid=0&output=html',
             embed_id:           'timeline-embed',               //OPTIONAL USE A DIFFERENT DIV ID FOR EMBED
         //   start_at_end:       false,                          //OPTIONAL START AT LATEST DATE
         //   start_at_slide:     '4',                            //OPTIONAL START AT SPECIFIC SLIDE
         //   start_zoom_adjust:  '3',                            //OPTIONAL TWEAK THE DEFAULT ZOOM LEVEL
         //   hash_bookmark:      true,                           //OPTIONAL LOCATION BAR HASHES
         //   font:               'Bevan-PotanoSans',             //OPTIONAL FONT
         //   debug:              true,                           //OPTIONAL DEBUG TO CONSOLE
            lang:               'en'                           //OPTIONAL LANGUAGE
         //   maptype:            'watercolor',                   //OPTIONAL MAP STYLE
         //   css:                '/css/timeline.css',     //OPTIONAL PATH TO CSS
         //   js:                 '/js/timeline.js'    //OPTIONAL PATH TO JS
        }
    </script>
    <script type="text/javascript" src="http://cdn.knightlab.com/libs/timeline/latest/js/storyjs-embed.js"></script>
    <script>
        $(document).ready(function(){
            setInterval(function() {
                $('.slide-tag').each(function(i, el){
                    var text = $(el).text();
                    text = encodeURIComponent(text);
                    if (text.indexOf("%E6%96%B0%E7%95%8C%E5%8F%8A%E9%9B%A2%E5%B3%B6") == 0) {
                        $(el).addClass('nt');
                    } else if (text.indexOf("%E4%B9%9D%E9%BE%8D") == 0) {
                        $(el).addClass('kl');
                    } else if (text.indexOf("%E9%A6%99%E6%B8%AF%E5%B3%B6") == 0) {
                        $(el).addClass('hk');
                    } else if (text.indexOf("%E5%85%A8%E6%B8%AF%E5%90%84%E8%99%95") == 0) {
                        $(el).addClass('all');
                    }
                });
            }, 1000);
        });
    </script>
</body>
</html>
